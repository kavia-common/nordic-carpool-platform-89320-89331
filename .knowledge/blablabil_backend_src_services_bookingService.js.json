{"is_source_file": true, "format": "JavaScript", "description": "This file defines the BookingService class, providing methods for creating, confirming, canceling, retrieving, and updating bookings within a ride-sharing or carpooling platform. It interacts with a database using transactions, handles business logic, and manages notifications and refunds.", "external_files": ["../config/database"], "external_methods": ["query", "transaction"], "published": ["new BookingService()"], "classes": [{"name": "BookingService", "description": "Service class encapsulating booking-related operations such as creation, confirmation, cancellation, retrieval, and updates."}], "methods": [{"name": "createBooking(passengerId, bookingData)", "description": "Creates a new booking for a passenger, verifies trip availability, processes payment, and logs the activity.", "scope": "BookingService", "scopeKind": "class"}, {"name": "confirmBooking(bookingId, driverId)", "description": "Allows a driver to confirm a passenger\u2019s booking, updating its status and logging the confirmation.", "scope": "BookingService", "scopeKind": "class"}, {"name": "cancelBooking(bookingId, userId, reason)", "description": "Cancels a booking, refunds the passenger if applicable, updates seat availability, and logs the cancellation.", "scope": "BookingService", "scopeKind": "class"}, {"name": "getUserBookings(passengerId, status = null, limit = 20, offset = 0)", "description": "Retrieves a list of bookings for a passenger, with optional status filtering and pagination.", "scope": "BookingService", "scopeKind": "class"}, {"name": "getTripBookings(tripId, driverId)", "description": "Retrieves all bookings for a specific trip, verifying driver ownership.", "scope": "BookingService", "scopeKind": "class"}, {"name": "getBookingById(bookingId, userId)", "description": "Fetches detailed information of a specific booking, verifying user authorization.", "scope": "BookingService", "scopeKind": "class"}, {"name": "updateBookingRequests(bookingId, passengerId, specialRequests)", "description": "Allows a passenger to update special requests on an existing booking.", "scope": "BookingService", "scopeKind": "class"}], "calls": ["client.query", "client.transaction", "query"], "search-terms": ["BookingService", "createBooking", "confirmBooking", "cancelBooking", "getUserBookings", "getTripBookings", "updateBookingRequests"], "state": 2, "file_id": 22, "knowledge_revision": 45, "git_revision": "", "ctags": [{"_type": "tag", "name": "BookingService", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^class BookingService {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "cancelBooking", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^  async cancelBooking(bookingId, userId, reason) {$/", "language": "JavaScript", "kind": "method", "signature": "(bookingId, userId, reason)", "scope": "BookingService", "scopeKind": "class"}, {"_type": "tag", "name": "confirmBooking", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^  async confirmBooking(bookingId, driverId) {$/", "language": "JavaScript", "kind": "method", "signature": "(bookingId, driverId)", "scope": "BookingService", "scopeKind": "class"}, {"_type": "tag", "name": "createBooking", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^  async createBooking(passengerId, bookingData) {$/", "language": "JavaScript", "kind": "method", "signature": "(passengerId, bookingData)", "scope": "BookingService", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^module.exports = new BookingService();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "getBookingById", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^  async getBookingById(bookingId, userId) {$/", "language": "JavaScript", "kind": "method", "signature": "(bookingId, userId)", "scope": "BookingService", "scopeKind": "class"}, {"_type": "tag", "name": "getTripBookings", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^  async getTripBookings(tripId, driverId) {$/", "language": "JavaScript", "kind": "method", "signature": "(tripId, driverId)", "scope": "BookingService", "scopeKind": "class"}, {"_type": "tag", "name": "getUserBookings", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^  async getUserBookings(passengerId, status = null, limit = 20, offset = 0) {$/", "language": "JavaScript", "kind": "method", "signature": "(passengerId, status = null, limit = 20, offset = 0)", "scope": "BookingService", "scopeKind": "class"}, {"_type": "tag", "name": "updateBookingRequests", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/bookingService.js", "pattern": "/^  async updateBookingRequests(bookingId, passengerId, specialRequests) {$/", "language": "JavaScript", "kind": "method", "signature": "(bookingId, passengerId, specialRequests)", "scope": "BookingService", "scopeKind": "class"}], "hash": "760bdebb2de5b3a558570ccb1a2589b2", "format-version": 4, "code-base-name": "blablabil_backend", "filename": "blablabil_backend/src/services/bookingService.js", "fields": [{"name": "module.exports = new BookingService();", "scope": "module", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"45": ""}]}