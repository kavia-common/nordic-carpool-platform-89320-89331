{"is_source_file": true, "format": "JavaScript", "description": "This file configures and manages PostgreSQL database connection pooling, connection testing, and transaction handling using the 'pg' library. It exposes functions for executing queries, obtaining clients, performing transactions, and health checks.", "external_files": ["pg", "dotenv"], "external_methods": ["Pool"], "published": ["query", "getClient", "transaction", "checkConnection", "pool"], "classes": [], "methods": [{"name": "query", "description": "Executes an SQL query with parameters and logs its execution time and result."}, {"name": "getClient", "description": "Provides a database client for manual transaction management."}, {"name": "transaction", "description": "Runs multiple queries within a transaction, committing or rolling back based on success or failure."}, {"name": "checkConnection", "description": "Checks if the database connection is healthy by executing a simple query."}], "calls": ["pool.query", "client.query", "pool.connect", "client.query('BEGIN')", "client.query('COMMIT')", "client.query('ROLLBACK')", "pool.query('SELECT 1')"], "search-terms": ["PostgreSQL connection pooling", "database configuration", "transaction management", "pg Pool", "connection health check"], "state": 2, "file_id": 13, "knowledge_revision": 27, "git_revision": "", "ctags": [{"_type": "tag", "name": "checkConnection", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^const checkConnection = async () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "client", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  const client = await pool.connect();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "connectionTimeoutMillis", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  connectionTimeoutMillis: 2000, \\/\\/ Return an error after 2 seconds if connection could not be/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "database", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  database: process.env.DB_NAME || 'blablabil_database',$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "dbConfig", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^const dbConfig = {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "duration", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^    const duration = Date.now() - start;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "getClient", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^const getClient = () => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "host", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  host: process.env.DB_HOST || 'localhost',$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "idleTimeoutMillis", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  idleTimeoutMillis: 30000, \\/\\/ Close idle clients after 30 seconds$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "max", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  max: 20, \\/\\/ Maximum number of clients in the pool$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  password: process.env.DB_PASSWORD || 'dbuser123',$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "pool", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^const pool = new Pool(dbConfig);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "port", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  port: process.env.DB_PORT || 5000,$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "query", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  query,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "query", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^const query = async (text, params) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "rejectUnauthorized", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig.ssl", "scopeKind": "class"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^    const result = await callback(client);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "result", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^    const result = await pool.query(text, params);$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "ssl", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false$/", "language": "JavaScript", "kind": "class", "scope": "dbConfig", "scopeKind": "class"}, {"_type": "tag", "name": "start", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  const start = Date.now();$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "transaction", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^const transaction = async (callback) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "user", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/config/database.js", "pattern": "/^  user: process.env.DB_USER || 'appuser',$/", "language": "JavaScript", "kind": "property", "scope": "dbConfig", "scopeKind": "class"}], "hash": "6ca9ebc294c32a1dfcfe59ed95a9bfa9", "format-version": 4, "code-base-name": "blablabil_backend", "filename": "blablabil_backend/src/config/database.js", "fields": [{"name": "connectionTimeoutMillis: 2000, \\/\\/ Return an error after 2 seconds if connection could not be/", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "database: process.env.DB_NAME || 'blablabil_database',", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "host: process.env.DB_HOST || 'localhost',", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "idleTimeoutMillis: 30000, \\/\\/ Close idle clients after 30 seconds", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "max: 20, \\/\\/ Maximum number of clients in the pool", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "password: process.env.DB_PASSWORD || 'dbuser123',", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "port: process.env.DB_PORT || 5000,", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}, {"name": "query,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}, {"name": "ssl: process.env.NODE_ENV === 'production' ? { rejectUnauthorized: false } : false", "scope": "dbConfig.ssl", "scopeKind": "class", "description": "unavailable"}, {"name": "user: process.env.DB_USER || 'appuser',", "scope": "dbConfig", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"27": ""}]}