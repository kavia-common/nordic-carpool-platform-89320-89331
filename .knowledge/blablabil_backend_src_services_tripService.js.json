{"is_source_file": true, "format": "JavaScript", "description": "Source code for the TripService class, which manages trip creation, searching, retrieval, updating, cancellation, and completion in a ride-sharing platform. It interfaces with a database via queries, handles trip lifecycle operations, and logs activities.", "external_files": ["../config/database"], "external_methods": ["query"], "published": ["TripService"], "classes": [{"name": "TripService", "description": "Encapsulates trip-related operations such as creation, search, retrieval, update, cancellation, and completion within the platform."}], "methods": [{"name": "createTrip(driverId, tripData)", "description": "Creates a new trip combining driver info, vehicle info, trip details, and optional waypoints; verifies driver and vehicle, inserts trip, waypoints, and logs activity.", "scope": "TripService", "scopeKind": "class"}, {"name": "searchTrips(searchParams)", "description": "Searches for trips based on various criteria such as origin, destination, departure date/time, price, and preferences, returning matching trip listings.", "scope": "TripService", "scopeKind": "class"}, {"name": "getTripById(tripId, userId = null)", "description": "Retrieves detailed information about a specific trip, including waypoints and bookings, and optionally includes user-specific booking info.", "scope": "TripService", "scopeKind": "class"}, {"name": "updateTrip(tripId, driverId, updateData)", "description": "Updates allowed fields of a trip, verifying ownership and trip status, and logs the update activity.", "scope": "TripService", "scopeKind": "class"}, {"name": "cancelTrip(tripId, driverId, reason)", "description": "Cancels a trip, updates status, cancels and refunds bookings, and logs activity.", "scope": "TripService", "scopeKind": "class"}, {"name": "getDriverTrips(driverId, status = null, limit = 20, offset = 0)", "description": "Fetches trips associated with a driver, optionally filtered by status, including summaries of bookings and earnings.", "scope": "TripService", "scopeKind": "class"}, {"name": "completeTrip(tripId, driverId)", "description": "Marks a trip as completed, updates related bookings, and logs completion activity.", "scope": "TripService", "scopeKind": "class"}], "calls": ["require('../config/database')", "client.query", "transaction(\u2026) -> async function", "query"], "search-terms": ["TripService", "createTrip", "searchTrips", "getTripById", "updateTrip", "cancelTrip", "getDriverTrips", "completeTrip", "trip_creation", "trip_update", "trip_cancellation", "trip_completion"], "state": 2, "file_id": 21, "knowledge_revision": 43, "git_revision": "", "ctags": [{"_type": "tag", "name": "TripService", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^class TripService {$/", "language": "JavaScript", "kind": "class"}, {"_type": "tag", "name": "cancelTrip", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^  async cancelTrip(tripId, driverId, reason) {$/", "language": "JavaScript", "kind": "method", "signature": "(tripId, driverId, reason)", "scope": "TripService", "scopeKind": "class"}, {"_type": "tag", "name": "completeTrip", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^  async completeTrip(tripId, driverId) {$/", "language": "JavaScript", "kind": "method", "signature": "(tripId, driverId)", "scope": "TripService", "scopeKind": "class"}, {"_type": "tag", "name": "createTrip", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^  async createTrip(driverId, tripData) {$/", "language": "JavaScript", "kind": "method", "signature": "(driverId, tripData)", "scope": "TripService", "scopeKind": "class"}, {"_type": "tag", "name": "exports", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^module.exports = new TripService();$/", "language": "JavaScript", "kind": "variable", "scope": "module", "scopeKind": "class"}, {"_type": "tag", "name": "getDriverTrips", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^  async getDriverTrips(driverId, status = null, limit = 20, offset = 0) {$/", "language": "JavaScript", "kind": "method", "signature": "(driverId, status = null, limit = 20, offset = 0)", "scope": "TripService", "scopeKind": "class"}, {"_type": "tag", "name": "getTripById", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^  async getTripById(tripId, userId = null) {$/", "language": "JavaScript", "kind": "method", "signature": "(tripId, userId = null)", "scope": "TripService", "scopeKind": "class"}, {"_type": "tag", "name": "searchTrips", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^  async searchTrips(searchParams) {$/", "language": "JavaScript", "kind": "method", "signature": "(searchParams)", "scope": "TripService", "scopeKind": "class"}, {"_type": "tag", "name": "updateTrip", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/services/tripService.js", "pattern": "/^  async updateTrip(tripId, driverId, updateData) {$/", "language": "JavaScript", "kind": "method", "signature": "(tripId, driverId, updateData)", "scope": "TripService", "scopeKind": "class"}], "hash": "b4981d49fd0a7c2017440f1de933983a", "format-version": 4, "code-base-name": "blablabil_backend", "filename": "blablabil_backend/src/services/tripService.js", "fields": [{"name": "module.exports = new TripService();", "scope": "module", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"43": ""}]}