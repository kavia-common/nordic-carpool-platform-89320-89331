{"is_source_file": true, "format": "JavaScript", "description": "This file defines various security-related middleware functions for an Express.js application, including rate limiting, security headers, input sanitization, event logging, and suspicious activity detection.", "external_files": ["../config/config", "express-rate-limit", "helmet"], "external_methods": ["require('express-rate-limit')", "require('helmet')"], "published": ["generalRateLimit", "authRateLimit", "passwordResetRateLimit", "tripCreationRateLimit", "securityHeaders", "sanitizeInput", "logSecurityEvent", "suspiciousActivityCheck"], "classes": [], "methods": [{"name": "sanitizeInput", "description": "Middleware function to sanitize user input in request bodies and query parameters to prevent XSS and injection attacks."}, {"name": "logSecurityEvent", "description": "Creates middleware that logs security-related events, capturing details such as IP, user agent, timestamp, and request info."}, {"name": "suspiciousActivityCheck", "description": "Middleware to detect potentially malicious requests based on pattern matching in request data."}], "calls": ["rateLimit()", "helmet()", "console.log()"], "search-terms": ["security middleware", "rate limiter", "helmet headers", "input sanitization", "security event logging", "suspicious activity detection"], "state": 2, "file_id": 17, "knowledge_revision": 35, "git_revision": "", "ctags": [{"_type": "tag", "name": "authRateLimit", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const authRateLimit = rateLimit({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "checkString", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^  const checkString = (str) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "config", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const config = require('..\\/config\\/config');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "eventType", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^      eventType,$/", "language": "JavaScript", "kind": "field", "scope": "logData", "scopeKind": "class"}, {"_type": "tag", "name": "generalRateLimit", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^  generalRateLimit,$/", "language": "JavaScript", "kind": "field", "scope": "module.exports", "scopeKind": "class"}, {"_type": "tag", "name": "generalRateLimit", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const generalRateLimit = rateLimit({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "helmet", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const helmet = require('helmet');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "logData", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^    const logData = {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "logSecurityEvent", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const logSecurityEvent = (eventType) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "passwordResetRateLimit", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const passwordResetRateLimit = rateLimit({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "rateLimit", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const rateLimit = require('express-rate-limit');$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "requestString", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^  const requestString = JSON.stringify({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sanitizeInput", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const sanitizeInput = (req, res, next) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sanitizeObject", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^  const sanitizeObject = (obj) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sanitizeString", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^  const sanitizeString = (str) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "sanitized", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^    const sanitized = {};$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "securityHeaders", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const securityHeaders = helmet({$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "suspiciousActivityCheck", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const suspiciousActivityCheck = (req, res, next) => {$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "suspiciousPatterns", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^  const suspiciousPatterns = [$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "tripCreationRateLimit", "path": "/home/kavia/workspace/code-generation/nordic-carpool-platform-89320-89331/blablabil_backend/src/middleware/security.js", "pattern": "/^const tripCreationRateLimit = rateLimit({$/", "language": "JavaScript", "kind": "constant"}], "hash": "6b0ff581f1596863577c8c649de9a4e8", "format-version": 4, "code-base-name": "blablabil_backend", "filename": "blablabil_backend/src/middleware/security.js", "fields": [{"name": "eventType,", "scope": "logData", "scopeKind": "class", "description": "unavailable"}, {"name": "generalRateLimit,", "scope": "module.exports", "scopeKind": "class", "description": "unavailable"}], "revision_history": [{"35": ""}]}